[request_definition]
r = sub, dom, obj, act

[policy_definition]
p = sub, dom, obj, act, scope

[role_definition]
g = _, _, _

[policy_effect]
e = some(where (p.eft == allow))

[matchers]
# 逻辑：
# 1. 如果用户在 '1' 租户下拥有 'admin' 角色，直接放行 (忽略 r.dom 和 p.dom)
#    '1' 租户在单租户模式下代表 'default' 租户，在多租户模式下代表 'system' 租户
# 2. 否则，走正常的租户 RBAC 匹配
m = g(r.sub, 'admin', '1') || \
    (g(r.sub, p.sub, r.dom) && r.dom == p.dom && r.obj == p.obj && r.act == p.act)


# 多租户模式开启时：
# 平台管理员所属租户 ID = system
# 客户 A 所属租户 ID = tenant_a
# 多租户模式关闭时：
# 所有用户（包括超级管理员）所属租户 ID = default
# 在多租户系统里，有些功能是只有 system 租户能看的（比如“租户管理”、“套餐定义”）。当切换到单租户模式时，这些功能通常有以下处理方式：
# 彻底隐藏：既然没有多租户了，“租户管理”这个功能在单租户系统里是没意义的，直接通过前端 UI 屏蔽。
# 功能下放：有些系统配置（比如“全站设置”、“日志审计”），在多租户里属于 system 租户，在单租户里就属于 default 租户。
